<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Twittler</title>
    <link rel="stylesheet" href="stylesheets/main.css">
    <script src="javascript/jquery.js"></script>
    <script src="javascript/data_generator.js"></script>
  </head>
  <body>
    <header class='primary-header container group'>
      <h1 class='logo'>
        <a href='index.html'>Twittler</a>
      </h1>
      <h3 class='tagline'>The Hack Reactor Way to Get Your Tweets!</h3>
    </header>
    <section class="row">
      <div class="grid">
        <section class="col-2-3">
          <h1>Tweets</h1>
          </br>
          <button class="btn btn-default" name="load">Pull New Tweets</button>
          </br>
          </br>
          <div class="tweets">
          </div>
        </section><!--
        --><form class="col-1-3" action="#" method="post">
          <fieldset class="tweet-group">
            <legend><h1>Tweet a Message</h1></br></legend>
            <label>
              Handle
              <input type="text" name="handle" placeholder="Please enter handle" required>
            </label>
            <label>
              Tweet
              <textarea name="tweet" placeholder="Type your tweet!"></textarea>
            </label>
          </fieldset>
          <input class="btn btn-default" type="submit" name="submit" value="Submit">
        </form>
      </div>
    </section>
    <footer class="primary-footer container">
      <small>Â© Hack Reactor</small>
    </footer>


    <script>

      $(document).ready(function(){

        var pullTweets = function() {
          var $tweetDiv = $('div.tweets');
          $tweetDiv.html('');
          var index = streams.home.length - 1;
          while(index >= 0) {
            var tweet = streams.home[index];
            var $tweet = $('<div class="tweet"></div>');
            $tweet.html('<h4 class="user-link">' + tweet.user + '</h4>"' 
              + tweet.message.trim() + '"</br><span class="created-time"">' 
              + tweet.created_at + '</span>');
            $tweet.appendTo($tweetDiv);
            index -= 1;
          }
        };

        var selectUser = function(user) {
          var $tweetDiv = $('div.tweets');
          $tweetDiv.html('');
          $tweetDiv.html('<h2>@' + user + '</h2></br>');
          var index = streams.users[user].length - 1;
          while(index >= 0) {
            var tweet = streams.users[user][index];
            var $tweet = $('<div class="tweet"></div>');
            $tweet.html('<h4 class="user-link">' + tweet.user + '</h4>"' 
              + tweet.message.trim() + '"</br><span class="created-time"">' 
              + tweet.created_at + '</span>');
            $tweet.appendTo($tweetDiv);
            index -= 1;
          }
        };

        $("button").on("click", pullTweets);
        $(document).on("click", "h4.user-link", function() {
          selectUser($(this).text());
        });

        pullTweets();

        // Somehow need to define the streams.users."your handle" whenever you create a new one
      });

    </script>
  </body>
</html>
